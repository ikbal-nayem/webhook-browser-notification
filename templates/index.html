<html>
	<head>
		<link rel="icon" href="https://gems.gov.bd/media/logos/bd-govt-bn.png" />
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
			rel="stylesheet"
			integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
			crossorigin="anonymous"
		/>
		<script type="text/javascript" src="/static/register-service-worker.js"></script>
		<title>Deployment Status</title>
	</head>
	<body>
		<div class="container">
			<h1 class="text-center text-primary">GEMS Deployment Status</h1>

			<div class="text-center mb-3">
				<button id="registerButton" class="btn btn-primary">Subscribe</button>
			</div>

			<div id="service-block" class="row">
				<form>
					<div class="col-md-4">
						<div class="card">
							<div class="card-header">
								<h5 class="card-title text-success">Stage</h5>
							</div>
							<div class="card-body">
								{% for s in services %}
								<div class="form-check">
									<input class="form-check-input" type="checkbox" value="" id="stage_{{s}}" />
									<label class="form-check-label" for="stage_{{s}}"> {{s}} </label>
								</div>
								{% endfor %}
							</div>
						</div>
					</div>
					<div class="col-md-4">
						<div class="card">
							<div class="card-header">
								<h5 class="card-title text-success">Training</h5>
							</div>
							<div class="card-body">
								{% for s in services %}
								<div class="form-check">
									<input class="form-check-input" type="checkbox" value="" id="training_{{s}}" />
									<label class="form-check-label" for="training_{{s}}"> {{s}} </label>
								</div>
								{% endfor %}
							</div>
						</div>
					</div>
					<div class="col-md-4">
						<div class="card">
							<div class="card-header">
								<h5 class="card-title text-success">Production</h5>
							</div>
							<div class="card-body">
								{% for s in services %}
								<div class="form-check">
									<input class="form-check-input" type="checkbox" value="" id="prod_{{s}}" />
									<label class="form-check-label" for="prod_{{s}}"> {{s}} </label>
								</div>
								{% endfor %}
							</div>
						</div>
					</div>
				</div>
				</form>
		</div>

		<script type="text/javascript">
			if (navigator.serviceWorker) {
				navigator.serviceWorker.getRegistrations().then((registration) => {
					if (registration?.length > 0) {
						console.log('Service worker is already registered:');
						document.getElementById('registerButton').style.display = 'none';
					} else {
						console.log('Service worker is not registered');
						document.getElementById('service-block').style.display = 'none';
					}
				});
			}

			const registerButton = document.getElementById('registerButton');
			registerButton.addEventListener('click', () => {
				registerServiceWorker(
					'/static/service-worker.js',
					"{{config['VAPID_PUBLIC_KEY']}}",
					'/service-worker/subscription',
					'Srabon'
				);
			});
		</script>
		<script
			src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
			integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
			crossorigin="anonymous"
		></script>
	</body>
</html>
